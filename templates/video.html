<script>
    let videoPlayer = document.getElementById('videoPlayer');
    let videoSource = document.getElementById('videoSource');
    let videoDuration = document.getElementById('videoDuration');
    let savedDuration = "{{ duration }}";  // Получаем длительность из шаблона

    function loadVideo(quality) {
        const videoId = "{{ video_id }}";
        const videoURL = `/stream?v=${videoId}&quality=${quality}`;
        
        videoPlayer.pause();
        videoSource.src = videoURL;
        videoPlayer.load();

        // Обновляем длительность в плеере
        videoPlayer.addEventListener('loadedmetadata', function() {
            updateDuration(savedDuration);
            videoPlayer.play();
        }, { once: true });
    }

    function updateDuration(duration) {
        const minutes = Math.floor(duration / 60);
        const seconds = Math.floor(duration % 60);
        videoDuration.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
    }
</script>